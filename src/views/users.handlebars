<div class="bg-white h-lvh">
    <div class="mx-auto max-w-2xl px-4 pb-8 sm:px-6 sm:py-8 lg:max-w-7xl lg:px-8">
        <div class="grid grid-cols-1 gap-x-6 gap-y-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 xl:gap-x-8">
            <span id="userLog" class="hidden">{{userLog}}</span>
            {{#each users}}

            <div
                class="group m-4 border-solid border-gray-900 border-4 justify-center p-4 w-full mx-auto flex flex-col justify-center text-balance bg-gray-200 text-center">
                {{!-- <div
                    class="cursor-pointer group aspect-h-1 aspect-w-1 w-full overflow-hidden rounded-lg bg-gray-200 xl:aspect-h-8 xl:aspect-w-7">
                    <img src="{{}}" alt="{{this.name}}."
                        class="h-52 sm:h-64 w-screen object-fill group-hover:opacity-85">
                </div> --}}
                <h1 class=" mt-1 text-md font-medium text-gray-900">{{this.name}}</h1>
                <h3 id="user_email" class=" mt-2 text-sm text-gray-900">{{this.email}}</h3>
                <h3 class=" mt-2 text-sm text-gray-900">{{this.role}}</h3>
                <div class="p-2">
                    <button>Editar rol</button>
                    <button onClick="deleteUser('{{this.email}}')">Borrar user</button>
                </div>


            </div>
            {{/each}}
        </div>
    </div>
</div>


<script>
    // Swal.fire
    function swalDelete() {
        Swal.fire({
            title: `Usuario borrado!!`,
            text: "Se borr贸 el usuario correctamente",
            icon: "warning"
        })
    }
    // Swal.fire
    function swalAdded() {
        Swal.fire({
            title: `Producto agregado!!`,
            text: "Se agreg贸 el producto correctamente",
            icon: "success"
        })
    }
    function swalPermission() {
        Swal.fire({
            title: `Error de permisos`,
            text: "No tiene permisos para realizar esta acci贸n",
            icon: "warning"
        })
    }
    function swalError(error) {
        Swal.fire({
            title: `Error al intentar la acci贸n`,
            text: error,
            icon: "warning"
        })
    }
    function deleteUser(email) {
        const email_login = document.getElementById('userLog').innerHTML
        if (email === email_login) return swalError('No se puede eliminar el usuario logueado')
        fetch(`/api/users/deleteUser/${email}`, {
            method: 'delete'
        })
            .then(result => result.json())
            .then(result => {
                if (result.status === 'error') return swalError(result.error)
                swalDelete()
            })
            .catch(error => alert(error))
    }
</script>